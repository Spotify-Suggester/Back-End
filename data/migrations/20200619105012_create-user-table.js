
exports.up = function(knex) {
  return knex.schema.createTable('User', col=>{
      col.increments('id');
      col.string('username',128)
        .notNullable();
      col.string('password',128)
        .notNullable();
  })
  .createTable('Playlist', col=>{
      col.increments('id');
      col.string('name',128)
        .notNullable();
  })

  .createTable('User_Playlists', col=>{
      col.integer('playlist_id')
        .unsigned()
         .notNullable()
        .references('Playlist.id')
        .onDelete('CASCADE')
        .onUpdate('CASCADE')
      col.integer('owner_id')
        .unsigned()
        .notNullable()
        .references('User.id')
        .onDelete('CASCADE')
        .onUpdate('CASCADE')
  })
  .createTable('Favorites', col=>{
      col.increments('id')
      col.integer('owner_id')
        .unsigned()
        .notNullable()
        .references('User.id')
        .onDelete('CASCADE')
        .onUpdate('CASCADE')
  })
   .createTable('Song',col=>{
      col.string('id',128)
        .notNullable()
        .unique()
      col.string('name',128)
        .notNullable()
        .unique()
      col.string('artist',128)
        .notNullable()
      col.string('album',128)
        .notNullable()
      col.integer('popularity')
        .unsigned()
        .notNullable() 
      col.integer('duration_ms')
        .unsigned()
        .notNullable()
      col.integer('key')
        .unsigned()
        .notNullable()
      col.integer('mode')
        .unsigned()
        .notNullable()
      col.integer('time_signature')
        .unsigned()
        .notNullable()
      col.integer('danceability')
        .unsigned()
        .notNullable()
      col.integer('energy')
        .unsigned()
        .notNullable()
      col.integer('instrumentalness')
        .unsigned()
        .notNullable()
      col.integer('liveness')
        .unsigned()
        .notNullable()
      col.integer('loudness')
        .unsigned()
        .notNullable()
      col.integer('speechiness')
        .unsigned()
        .notNullable()
      col.integer('valence')
        .unsigned()
        .notNullable()
      col.integer('tempo')
        .unsigned()
        .notNullable()    
  })
    .createTable('Playlist_Songs', col=>{
        col.integer('playlist_id')
           .references('Playlist.id')
           .unsigned()
           .notNullable()
           .onUpdate('CASCADE')
           .onDelete('CASCADE')
        col.integer('song_id')
            .references('Song.id')
            .unsigned()
            .notNullable()
            .onUpdate('CASCADE')
            .onDelete('CASCADE')
    })
    .createTable('Favorite_Songs', col=>{
        col.integer('favorites-id')
            .references('Favorites.id')
            .unsigned()
            .notNullable()
            .onDelete('CASCADE')
            .onUpdate('CASCADE')
        col.integer('song_id')
            .references('Song.id')
            .unsigned()
            .notNullable()
            .onUpdate('CASCADE')
            .onDelete('CASCADE')
    })
};

exports.down = function(knex) {
  return knex.schema
  .dropTableIfExists('Favorite_Songs')
  .dropTableIfExists('Playlist_Songs')
  .dropTableIfExists('Song')
  .dropTableIfExists('Favorites')
  .dropTableIfExists('User_Playlists')
  .dropTableIfExists('Playlist')
  .dropTableIfExists('User')
  
};
